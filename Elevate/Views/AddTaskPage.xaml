<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Elevate.AddTaskPage"
             BackgroundColor="#F5F7F5">
    <ContentPage.Resources>
        <Color x:Key="PrimaryDark">#778873</Color>
        <Color x:Key="PrimaryLight">#A1BC98</Color>
        <Color x:Key="TextDark">#4A4A4A</Color>
        <Color x:Key="White">#FFFFFF</Color>
        <Color x:Key="Error">#E57373</Color>
    </ContentPage.Resources>

    <Grid RowDefinitions="Auto, Auto, *" Padding="20,10,20,0">

        <VerticalStackLayout Grid.Row="0" Spacing="5" Margin="0,10,0,20">
            <Label Text="My Tasks"
                   FontSize="32"
                   FontAttributes="Bold"
                   TextColor="{StaticResource PrimaryDark}" />
            <Label Text="Stay organized and productive"
                   FontSize="14"
                   TextColor="#999" />
        </VerticalStackLayout>

        <Border Grid.Row="1"
                StrokeShape="RoundRectangle 25"
                StrokeThickness="0"
                BackgroundColor="{StaticResource White}"
                HeightRequest="60"
                Margin="0,0,0,20">

            <Border.Shadow>
                <Shadow Brush="Black" Offset="0,4" Radius="10" Opacity="0.05"/>
            </Border.Shadow>

            <Grid ColumnDefinitions="*, Auto">
                <Entry Grid.Column="0"
                       Text="{Binding NewTodoText}"
                       Placeholder="What needs to be done?"
                       PlaceholderColor="#CCC"
                       TextColor="{StaticResource TextDark}"
                       FontSize="16"
                       Margin="20,0"
                       VerticalOptions="Center" />

                <Button Grid.Column="1"
                        Text="Add"
                        FontAttributes="Bold"
                        TextColor="{StaticResource White}"
                        BackgroundColor="{StaticResource PrimaryDark}"
                        CornerRadius="20"
                        HeightRequest="40"
                        WidthRequest="80"
                        Margin="10"
                        Command="{Binding AddItemCommand}" />
            </Grid>
        </Border>

        <CollectionView Grid.Row="2" 
                        ItemsSource="{Binding tasks}"
                        Margin="0,10,0,0">

            <CollectionView.ItemsLayout>
                <LinearItemsLayout Orientation="Vertical" ItemSpacing="12" />
            </CollectionView.ItemsLayout>

            <CollectionView.EmptyView>
                <StackLayout VerticalOptions="Center" HorizontalOptions="Center" Spacing="10">
                    <Label Text="No tasks yet." TextColor="#CCC" FontSize="18" HorizontalOptions="Center"/>
                </StackLayout>
            </CollectionView.EmptyView>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border StrokeShape="RoundRectangle 15"
                            StrokeThickness="0"
                            BackgroundColor="{StaticResource White}"
                            Padding="15">

                        <Border.Shadow>
                            <Shadow Brush="Black" Offset="0,2" Radius="5" Opacity="0.05"/>
                        </Border.Shadow>

                        <Grid ColumnDefinitions="*, Auto">

                            <Label Grid.Column="0"
                                   Text="{Binding Name}"
                                   FontSize="16"
                                   VerticalOptions="Center"
                                   LineBreakMode="TailTruncation"
                                   TextColor="{StaticResource TextDark}" />

                            <Button Grid.Column="1"
                                    Text="✕"
                                    FontSize="14"
                                    BackgroundColor="#FFF0F0"
                                    TextColor="{StaticResource Error}"
                                    CornerRadius="10"
                                    HeightRequest="35"
                                    WidthRequest="35"
                                    Padding="0"
                                    Command="{Binding Path=BindingContext.DeleteTaskCommand, Source={RelativeSource AncestorType={x:Type ContentPage}}}"
                                    CommandParameter="{Binding .}" />
                        </Grid>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

    </Grid>
</ContentPage>